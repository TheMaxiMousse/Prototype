---
import '../styles/global.css'
import Main from '../layouts/Main.astro'
import NewProduct from '../components/NewProduct.astro'
import ProductCard from '../components/ProductCard.astro'
import SearchBar from '../components/SearchBar.astro'
import products from '../assets/products.json'

import { SITE_NAME } from '../config.js'
const description = 'Rich and indulgent chocolate spread made from the finest ingredients.'
---

<Main title=`${SITE_NAME}`>
    <!-- <div id="search-product">
        <SearchBar placeholder="Search for products..." />
    </div> -->
    <section id="promoted-product">
        <h1>Luxury Chocolate Paste</h1>
        <p>{description}</p>
        <button title="We're still working on the shop" disabled>Shop now</button>
        <img src="product/1.png" alt="Hazelnut Chocolate" />
    </section>
    <hr class="section-divider" />
    <section id="product-list">
        <div id="admin-add-product" style="display: none;">
            <NewProduct />
        </div>
        {
            products.map((product) => (
                <ProductCard product_id={product.product_id} product_name={product.product_name} />
            ))
        }
    </section>
</Main>

<style>
    .section-divider {
        border: none;
        border-top: 2px solid var(--color-accent, #8b5c2a);
        margin: 2rem auto;
        width: 100%;
        opacity: 0.5;
    }

    #promoted-product {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(5, 1fr);
        grid-column-gap: 15px;
        grid-row-gap: 15px;
        align-items: start;
        justify-items: start;
        max-height: 45svh;
    }

    #promoted-product > * {
        align-self: center;
        justify-self: center;
    }

    #promoted-product > h1 {
        font-size: 70px;
        text-wrap: wrap;
        width: 1px;
        justify-self: start;
        grid-area: 2 / 1 / 3 / 2;
    }

    #promoted-product > p {
        font-size: 35px;
        grid-area: 3 / 1 / 4 / 2;
    }

    #promoted-product > button {
        padding: 1rem 2rem;
        font-size: x-large;
        grid-area: 4 / 1 / 5 / 2;
    }

    #promoted-product img {
        grid-area: 1 / 2 / 6 / 3;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: var(--border-radius-large);
    }

    @media screen and (width<=1200px) {
        #promoted-product {
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(4, 1fr);
            grid-column-gap: 15px;
            grid-row-gap: 15px;
        }

        #promoted-product > h1 {
            font-size: 62px;
            width: auto;
            grid-area: 1 / 1 / 2 / 3;
        }

        #promoted-product > p {
            font-size: 30px;
            width: 100%;
            grid-area: 2 / 1 / 4 / 2;
            padding-left: 1rem;
        }

        #promoted-product > button {
            grid-area: 4 / 1 / 5 / 2;
        }

        #promoted-product img {
            grid-area: 2 / 2 / 5 / 3;
        }
    }

    @media screen and (width<=850px) {
        #promoted-product {
            grid-template-columns: 1fr;
            grid-template-rows: auto;
            grid-column-gap: 15px;
            grid-row-gap: 15px;
            max-height: none;
        }

        #promoted-product > h1 {
            font-size: 23px;
            grid-area: 1 / 1 / 2 / 2;
            width: 100%;
        }

        #promoted-product > p {
            font-size: 20px;
            grid-area: 2 / 1 / 3 / 2;
            padding-left: 0;
            text-wrap: balance;
        }

        #promoted-product > button {
            grid-area: 4 / 1 / 5 / 2;
        }

        #promoted-product img {
            /* border-radius: 0; */
            grid-area: 3 / 1 / 4 / 2;
            width: 100%;
            height: auto;
            max-height: 250px;
            object-fit: cover;
            display: block;
            margin: 0 auto;
        }
    }

    #search-product {
        display: flex;
        justify-content: center;
        width: clamp(320px, var(--card-size), 100svw);
    }

    #product-list {
        align-items: center;
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-medium);
        justify-content: center;
        width: 80%;
    }

    @media screen and (width<=850px) {
        #product-list {
            gap: var(--spacing-small);
            height: 100%;
            width: 100%;
        }
    }
</style>

<script type="module" is:inline>
    function showAddProduct() {
        if (document.cookie.includes('loggedIn=true') && document.cookie.includes('isAdmin=true')) {
            document.getElementById('admin-add-product').style.display = 'flex'
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', showAddProduct)
    } else {
        showAddProduct()
    }
</script>
